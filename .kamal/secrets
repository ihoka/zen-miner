#!/usr/bin/env bash

# Secrets for Kamal deployment - fetched from 1Password at deploy time.
# This file is safe to commit - it contains NO actual secret values.
#
# =============================================================================
# OPEN SOURCE PROJECT - SECRETS MANAGEMENT
# =============================================================================
# Since this is an open source project, secrets are stored in 1Password
# and fetched at deploy time by maintainers only.
#
# Required secrets in your 1Password vault:
#   - KAMAL_REGISTRY_USERNAME: Docker Hub username
#   - KAMAL_REGISTRY_PASSWORD: Docker Hub access token
#   - RAILS_MASTER_KEY: Rails credentials master key
#
# =============================================================================
# 1PASSWORD INTEGRATION
# =============================================================================
# Prerequisites:
#   1. Install 1Password CLI: brew install --cask 1password-cli
#   2. Enable 1Password SSH agent in 1Password settings
#   3. Create an item in 1Password with the required fields
#
# To create the item in 1Password:
#   1. Open 1Password app
#   2. Create a new "Secure Note" or "Password" item named "Zen Miner Production"
#   3. Add fields: KAMAL_REGISTRY_USERNAME, KAMAL_REGISTRY_PASSWORD, RAILS_MASTER_KEY
#
# TODO: Update the item reference below to match your 1Password item
# Format: op://vault/item/field

# =============================================================================
# PRIMARY METHOD: Environment Variables
# =============================================================================
# All secrets from environment variables
KAMAL_REGISTRY_USERNAME="${KAMAL_REGISTRY_USERNAME}"
KAMAL_REGISTRY_PASSWORD="${KAMAL_REGISTRY_PASSWORD}"
RAILS_MASTER_KEY="${RAILS_MASTER_KEY}"

# =============================================================================
# ALTERNATIVE: 1Password (if op CLI is configured and fast)
# =============================================================================
# Uncomment below if you prefer to use 1Password
# Make sure to run: eval $(op signin) first
#
# KAMAL_REGISTRY_USERNAME=$(op read "op://Private/Zen Miner Production/username")
# KAMAL_REGISTRY_PASSWORD=$(op read "op://Private/Zen Miner Production/password")
# RAILS_MASTER_KEY=$(op read "op://Private/Zen Miner Production/RAILS_MASTER_KEY")
